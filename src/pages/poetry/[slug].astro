---
import { getCollection, render } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import ContentDetail from "../../components/ContentDetail.astro";
import { buildContentJsonLd } from "../../utils/json-ld";

export async function getStaticPaths() {
  const poetryEntries = await getCollection("poetry");
  return poetryEntries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

const jsonLd = buildContentJsonLd({
  type: "CreativeWork",
  title: entry.data.title,
  url: new URL(Astro.url.pathname, Astro.site).href,
  date: entry.data.date,
  description: entry.data.description,
});
---

<BaseLayout
  title={entry.data.title}
  description={entry.data.description}
  jsonLd={jsonLd}
>
  <ContentDetail title={entry.data.title} date={entry.data.date}>
    <Content />
  </ContentDetail>
</BaseLayout>
