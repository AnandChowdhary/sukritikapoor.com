---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const proseEntries = await getCollection('prose');
const sortedEntries = proseEntries.sort((a, b) => {
  const dateA = a.data.date ? new Date(a.data.date).getTime() : 0;
  const dateB = b.data.date ? new Date(b.data.date).getTime() : 0;
  return dateB - dateA;
});
---

<BaseLayout title="Prose">
  <h1 class="font-serif font-black text-6xl md:text-7xl lg:text-8xl mb-16">Prose</h1>

  <div class="space-y-10">
    {sortedEntries.map(entry => {
      const date = entry.data.date ? new Date(entry.data.date) : null;
      const formattedDate = date ? date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : '';
      return (
        <a href={`/prose/${entry.id}`} class="block group">
          {formattedDate && <p class="text-accent text-sm mb-1">{formattedDate}</p>}
          <h2 class="font-serif font-black text-3xl md:text-4xl lg:text-5xl group-hover:text-accent transition-colors">
            {entry.data.title}
          </h2>
          {entry.data.description && <p class="mt-2 text-base text-gray-600">{entry.data.description}</p>}
        </a>
      );
    })}
  </div>
</BaseLayout>
